<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜¤ëŠ˜ì˜ ì•¼ì™¸ í™œë™ ì¡°ì–¸</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Noto Sans KR', sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background-color: #f0f4f8; /* ê¸°ë³¸ ë°°ê²½ìƒ‰ */
            transition: background-color 1s ease-in-out;
            color: #333;
            text-align: center;
            flex-direction: column;
        }
        .weather-card {
            background-color: #fff;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
            padding: 40px;
            max-width: 600px;
            width: 90%;
            transition: transform 0.3s ease-in-out;
        }
        .weather-card:hover {
            transform: translateY(-5px);
        }
        #city-name {
            font-size: 2.2em;
            font-weight: 700;
            color: #2c3e50;
            margin-bottom: 10px;
        }
        #weather-icon {
            font-size: 5em;
            margin: 20px 0;
            animation: bounce 0.8s infinite alternate;
        }
        @keyframes bounce {
            from { transform: translateY(0); }
            to { transform: translateY(-10px); }
        }
        #main-advice {
            font-size: 1.8em;
            font-weight: 700;
            color: #2980b9;
            margin-bottom: 20px;
            line-height: 1.4;
        }
        #detail-advice {
            font-size: 1.1em;
            color: #7f8c8d;
            line-height: 1.6;
        }
        #loading {
            font-size: 1.5em;
            color: #555;
        }
        .footer {
            margin-top: 30px;
            font-size: 0.9em;
            color: #aaa;
        }

        /* ë‚ ì”¨ë³„ ë°°ê²½ìƒ‰ (ì˜ˆì‹œ) */
        body.sunny { background-color: #87CEEB; } /* SkyBlue */
        body.cloudy { background-color: #BDC3C7; } /* Silver */
        body.rainy { background-color: #708090; }  /* SlateGray */
        body.snowy { background-color: #E0FFFF; }  /* LightCyan */
        body.bad-weather { background-color: #FF6347; } /* Tomato */
    </style>
</head>
<body>
    <div class="weather-card">
        <p id="city-name">ë‚ ì”¨ ì •ë³´ ë¡œë”© ì¤‘...</p>
        <div id="weather-icon">â˜ï¸</div>
        <h2 id="main-advice"></h2>
        <p id="detail-advice"></p>
        <div id="loading" style="display: none;">ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘...</div>
    </div>
    <div class="footer">
        OpenWeatherMap API ê¸°ë°˜ ì •ë³´ ì œê³µ
    </div>

    <script>
        // TODO: ì—¬ê¸°ì— ì‹¤ì œ Azure Functionì˜ HTTP íŠ¸ë¦¬ê±° URLì„ ë¶™ì—¬ë„£ìœ¼ì„¸ìš”.
        const AZURE_FUNCTION_URL = "https://weather-forecast-aqcfdphpe6hkcxd9.koreacentral-01.azurewebsites.net/api/HttpTrigger1"; 

        async function getLeisureAdvice() {
            const loadingElement = document.getElementById('loading');
            loadingElement.style.display = 'block';

            try {
                const response = await fetch(AZURE_FUNCTION_URL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                document.getElementById('city-name').innerText = data.city ? `${data.city}ì˜ ì˜¤ëŠ˜ ë‚ ì”¨` : 'ì•Œ ìˆ˜ ì—†ëŠ” ì§€ì—­';

                const [conclusion, detailAdvice] = data.advice.split('\n\n[ìƒì„¸ ì¡°ì–¸]');
                document.getElementById('main-advice').innerText = conclusion.trim();
                document.getElementById('detail-advice').innerText = detailAdvice ? detailAdvice.trim() : '';
                
                // ë‚ ì”¨ ì•„ì´ì½˜ ë° ë°°ê²½ ë³€ê²½ (ê°„ë‹¨í•œ ë¡œì§ ì˜ˆì‹œ)
                let icon = 'â“';
                let bgColorClass = '';

                if (conclusion.includes('ìµœê³ ì˜ ì•¼ì™¸ í™œë™ ì¡°ê±´!')) {
                    icon = 'â˜€ï¸'; // ë§‘ìŒ
                    bgColorClass = 'sunny';
                } else if (conclusion.includes('ê´œì°®ì€ í™œë™ ì¡°ê±´!')) {
                    icon = 'ğŸŒ¤ï¸'; // ë¶€ë¶„ì ìœ¼ë¡œ ë§‘ìŒ/êµ¬ë¦„
                    bgColorClass = 'cloudy';
                } else if (conclusion.includes('ì•¼ì™¸ í™œë™ì„ ì ì‹œ ë¯¸ë£¨ì„¸ìš”.')) {
                     if (detailAdvice && detailAdvice.includes('ë¹„, ëˆˆ ë˜ëŠ” í­í’ìš°')) {
                        icon = 'â˜”'; // ë¹„
                        bgColorClass = 'rainy';
                    } else if (detailAdvice && detailAdvice.includes('ì•ˆê°œ')) {
                        icon = 'ğŸŒ«ï¸'; // ì•ˆê°œ
                        bgColorClass = 'cloudy'; // ì•ˆê°œë„ êµ¬ë¦„ê³¼ ìœ ì‚¬í•œ ë¶„ìœ„ê¸°
                    } else if (detailAdvice && detailAdvice.includes('ë°”ëŒì´ ë§¤ìš° ê°•í•©ë‹ˆë‹¤.')) {
                        icon = 'ğŸŒ¬ï¸'; // ê°•í’
                        bgColorClass = 'cloudy'; 
                    } else {
                        icon = 'âš ï¸'; // ê²½ê³ 
                        bgColorClass = 'bad-weather';
                    }
                }
                document.getElementById('weather-icon').innerText = icon;
                document.body.className = bgColorClass; // ë°°ê²½ í´ë˜ìŠ¤ ë³€ê²½

            } catch (error) {
                console.error("ë‚ ì”¨ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
                document.getElementById('city-name').innerText = "ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
                document.getElementById('main-advice').innerText = "ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.";
                document.getElementById('detail-advice').innerText = "";
                document.getElementById('weather-icon').innerText = 'âŒ';
                document.body.className = 'bad-weather';
            } finally {
                loadingElement.style.display = 'none';
            }
        }

        getLeisureAdvice(); // í˜ì´ì§€ ë¡œë“œ ì‹œ í•¨ìˆ˜ ì‹¤í–‰
        // 5ë¶„ë§ˆë‹¤ ì—…ë°ì´íŠ¸ (ì„ íƒ ì‚¬í•­)
        // setInterval(getLeisureAdvice, 300 * 1000); 
    </script>
</body>
</html>